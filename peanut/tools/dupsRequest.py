#!/usr/bin/python
import requests
import json
import sys, os

def getMetadata(filename):
	metadata = dict()

	metadata["161775-thumb-156.jpg"] = ('2012-01-07 21:35:35', '{"{Exif}": {"PixelXDimension": 3264, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 2448, "DateTimeDigitized": "2012:01:07 21:35:35", "DateTimeOriginal": "2012:01:07 21:35:35", "BrightnessValue": -0.5015202702702702, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [500], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:35:35"}, "{ExifAux}": {"Regions": {"HeightAppliedTo": 2448, "RegionList": [{"Timestamp": -582412957, "Height": 0.121, "Width": 0.09, "ConfidenceLevel": 302, "Y": 0.346, "X": 0.516, "FaceID": 1, "Type": "Face"}, {"Timestamp": -582412957, "Height": 0.137, "Width": 0.103, "ConfidenceLevel": 260, "Y": 0.317, "X": 0.597, "Type": "Face"}], "WidthAppliedTo": 3264}}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:35:35", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 3264, "{GPS}": {"ImgDirection": 341.4338235294118, "AltitudeRef": 0, "DateStamp": "2012:01:07", "TimeStamp": "06:32:21", "Altitude": 58, "Longitude": 122.4208333333333, "ImgDirectionRef": "T", "Latitude": 37.79016666666666, "LatitudeRef": "N", "LongitudeRef": "W"}, "PixelHeight": 2448, "DPIWidth": 72}')
	metadata["161875-thumb-156.jpg"] = ('2012-01-07 21:37:01', '{"{Exif}": {"PixelXDimension": 3264, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 2448, "DateTimeDigitized": "2012:01:07 21:37:01", "DateTimeOriginal": "2012:01:07 21:37:01", "BrightnessValue": -0.7094379639448568, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [640], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:37:01"}, "{ExifAux}": {"Regions": {"HeightAppliedTo": 2448, "RegionList": [{"Timestamp": 1261027957, "Height": 0.104, "Width": 0.078, "ConfidenceLevel": 296, "Y": 0.391, "X": 0.4, "FaceID": 1, "Type": "Face"}, {"Timestamp": 1261027957, "AngleInfoYaw": 315, "Height": 0.183, "Width": 0.137, "ConfidenceLevel": 265, "Y": 0.383, "X": 0.678, "Type": "Face"}], "WidthAppliedTo": 3264}}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:37:01", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 3264, "{GPS}": {"ImgDirection": 141.5061224489796, "AltitudeRef": 0, "DateStamp": "2012:01:07", "TimeStamp": "05:37:23", "Altitude": 85, "Longitude": 122.4208333333333, "ImgDirectionRef": "T", "Latitude": 37.79016666666666, "LatitudeRef": "N", "LongitudeRef": "W"}, "PixelHeight": 2448, "DPIWidth": 72}')
	metadata["164591-thumb-156.jpg"] = ('2012-01-07 21:37:01', '{"{Exif}": {"PixelXDimension": 2048, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 1536, "DateTimeDigitized": "2012:01:07 21:37:01", "DateTimeOriginal": "2012:01:07 21:37:01", "BrightnessValue": -0.7094379639448568, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [640], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:37:01"}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:37:01", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 2048, "{GPS}": {"ImgDirection": 141.5061224489796, "AltitudeRef": 0, "DateStamp": "2012:01:07", "TimeStamp": "05:37:23", "Altitude": 85, "Longitude": 122.4208333333333, "ImgDirectionRef": "T", "Latitude": 37.79016666666666, "LatitudeRef": "N", "LongitudeRef": "W"}, "PixelHeight": 1536, "DPIWidth": 72, "{JFIF}": {"JFIFVersion": [1, 1], "DensityUnit": 1, "XDensity": 72, "YDensity": 72}}')
	metadata["164592-thumb-156.jpg"] = ('2012-01-07 21:36:53', '{"{Exif}": {"PixelXDimension": 2048, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 1536, "DateTimeDigitized": "2012:01:07 21:36:53", "DateTimeOriginal": "2012:01:07 21:36:53", "BrightnessValue": -0.6683507758931794, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [640], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:36:53"}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:36:53", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 2048, "{GPS}": {"LatitudeRef": "N", "AltitudeRef": 0, "TimeStamp": "07:04:44", "Altitude": 87, "Longitude": 122.4208333333333, "DateStamp": "2012:01:07", "Latitude": 37.78983333333333, "LongitudeRef": "W"}, "PixelHeight": 1536, "DPIWidth": 72, "{JFIF}": {"JFIFVersion": [1, 1], "DensityUnit": 1, "XDensity": 72, "YDensity": 72}}')
	metadata["164593-thumb-156.jpg"] = ('2012-01-07 21:36:50', '{"{Exif}": {"PixelXDimension": 2048, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 1536, "DateTimeDigitized": "2012:01:07 21:36:50", "DateTimeOriginal": "2012:01:07 21:36:50", "BrightnessValue": -0.7919001528273052, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [640], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:36:50"}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:36:50", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 2048, "{GPS}": {"LatitudeRef": "N", "AltitudeRef": 0, "TimeStamp": "06:59:45", "Altitude": 88, "Longitude": 122.4208333333333, "DateStamp": "2012:01:07", "Latitude": 37.78983333333333, "LongitudeRef": "W"}, "PixelHeight": 1536, "DPIWidth": 72, "{JFIF}": {"JFIFVersion": [1, 1], "DensityUnit": 1, "XDensity": 72, "YDensity": 72}}')
	metadata["164594-thumb-156.jpg"] = ('2012-01-07 21:36:46', '{"{Exif}": {"PixelXDimension": 2048, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 9.820433436532507, "ColorSpace": 1, "PixelYDimension": 1536, "DateTimeDigitized": "2012:01:07 21:36:46", "DateTimeOriginal": "2012:01:07 21:36:46", "BrightnessValue": 8.565193060996084, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [64], "ExposureTime": 0.001106194690265487, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:36:46"}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:36:46", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 2048, "{GPS}": {"LatitudeRef": "N", "AltitudeRef": 0, "TimeStamp": "06:45:01", "Altitude": 58.96666666666667, "Longitude": 122.4206666666667, "DateStamp": "2012:01:07", "Latitude": 37.79, "LongitudeRef": "W"}, "PixelHeight": 1536, "DPIWidth": 72, "{JFIF}": {"JFIFVersion": [1, 1], "DensityUnit": 1, "XDensity": 72, "YDensity": 72}}')
	metadata["164595-thumb-156.jpg"] = ('2012-01-07 21:35:35', '{"{Exif}": {"PixelXDimension": 2048, "Sharpness": 0, "ExposureMode": 0, "Flash": 9, "SceneCaptureType": 0, "SubjectArea": [1631, 1223, 881, 881], "MeteringMode": 5, "ExifVersion": [2, 2, 1], "ExposureProgram": 2, "ShutterSpeedValue": 3.965806451612903, "ColorSpace": 1, "PixelYDimension": 1536, "DateTimeDigitized": "2012:01:07 21:35:35", "DateTimeOriginal": "2012:01:07 21:35:35", "BrightnessValue": -0.5015202702702702, "WhiteBalance": 0, "SensingMethod": 2, "FNumber": 2.4, "ApertureValue": 2.52606882168926, "FocalLength": 4.28, "ComponentsConfiguration": [1, 2, 3, 0], "ISOSpeedRatings": [500], "ExposureTime": 0.0625, "FocalLenIn35mmFilm": 35, "FlashPixVersion": [1, 0]}, "Orientation": 1, "ColorModel": "RGB", "{DFCameraRollExtras}": {"DateTimeCreated": "2012:01:07 21:35:35"}, "DPIHeight": 72, "Depth": 8, "{TIFF}": {"YResolution": 72, "ResolutionUnit": 2, "Orientation": 1, "Make": "Apple", "DateTime": "2012:01:07 21:35:35", "XResolution": 72, "Model": "iPhone 4S", "Software": "5.0.1"}, "PixelWidth": 2048, "{GPS}": {"ImgDirection": 341.4338235294118, "AltitudeRef": 0, "DateStamp": "2012:01:07", "TimeStamp": "06:32:21", "Altitude": 58, "Longitude": 122.4208333333333, "ImgDirectionRef": "T", "Latitude": 37.79016666666666, "LatitudeRef": "N", "LongitudeRef": "W"}, "PixelHeight": 1536, "DPIWidth": 72, "{JFIF}": {"JFIFVersion": [1, 1], "DensityUnit": 1, "XDensity": 72, "YDensity": 72}}')

	return metadata[filename]
	
def getFilesAndData(rootdir, num):
	count = 0

	files = dict()
	dataArray = list()

	for subdir, dirs, filenames in os.walk(rootdir):
		for filename in filenames:
			keyName = "key" + str(count)
			filepath = os.path.join(rootdir, filename)
			files[keyName] = open(filepath, "r")

			data = dict()
			data["file_key"] = keyName
			data["user"] = 133
			data["time_taken"], data["metadata"] = getMetadata(filename)
			dataArray.append(data)
			count += 1

	return (files, dataArray)

def main(argv):
	url = "http://prod.duffyapp.com/api/photos/bulk/"
	(files, dataArray) = getFilesAndData("/Users/derek/Dropbox/Projects/Duffy/thumbs/dups", 100)

	payload = {'bulk_photos': json.dumps(dataArray)}
	r = requests.post(url, files=files, data=payload)

	print r.text

if __name__ == "__main__":
	main(sys.argv[1:])