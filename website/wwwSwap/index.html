<!DOCTYPE html>
<html>
<head>
	<title> Download Swap </title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="/resources/swap.css" media="screen" />
	<script src='/resources/jquery-1.10.2.min.js'> </script>
	<script src="/resources/jquery.maskedinput.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="//web.localytics.com/latest/localytics.min.js"></script>
	<script type="text/javascript">
		var localytics = LocalyticsSession("a592cd77469784a29d9bb69-f41b5cee-2171-11e4-4a11-00a426b17dd8", {logger:true, namespace:"websdk"});
		localytics.open();
	</script>
	<style>
	body {
		margin: 0px;
		font-family: HelveticaNeue;	
		overflow: scroll;
	}
	.ui-content {
		overflow: scroll;
	}
	.ui-header {
		position: fixed;
		overflow: auto;
		height: 76px;
		padding: 0px;
		width: 100%;
		box-shadow: 0px 1px 2px rgba(0,0,0,0.5);
		z-index: 100;
	}
	.ui-header-lhs {
		float:left;
	}
	.ui-header-rhs {
		float:right;
		margin-right: 10px;
		margin-top: 25px;
	}
	.ui-header-top-text {
		font-size: 16px;
		color: #000000;
		line-height: 20px;
		padding-top: 19px;
	}
	.ui-header-bottom-text {
		font-size: 14px;
		color: #4A4A4A;
		line-height: 17px;
	}
	img.ui-icon {
		float:left;
		height: 49px;
		width: 49px;
		margin: 10px;
		border-radius: 6px;
	}	
	.ui-body {
		margin-top: 89px;
		overflow: auto;
	}
	.ui-screenshots {
		margin-right: auto;
		margin-left: auto;
		position:relative;
		text-align: center;
		/*width: 161px;*/
	}
	img.ui-image {
		display:block;
		margin-right: auto;
		margin-left: auto;
		height: 350px;
	}
	img.ui-home-button {
		position: absolute;
		top: 305px;
		left: 146px;
		height: 26px;
		width: 26px;
	}
	.ui-clickable-button {
		background: #50A1FF;
		font-family: HelveticaNeue;
		font-size: 16px;
		color: #FFFFFF;
		line-height: 19px;
		border-radius: 12px;
		border: 0px solid white;
		padding: 3px 19px;		
	}
	.ui-install-button{
		
	}

	.ui-button-clicked {
		background: #979797;
	}
	.ui-submit-button {
		width: 100px;
		text-align: center;
		margin-right: auto;
		margin-left: auto;
		margin-top: 20px;
	}
	.ui-phone-num {
		float: left;
		padding: 0px 25px 20px 25px;
		text-align: center;
		font-size: 17px;
		line-height: 20px;
		margin-bottom:15px;
		margin-top:30px;
	}
	.textbox {
	    border: 1px solid #c4c4c4; 
	    border-radius: 4px;
	    color: #b2b2b2;
	    outline:0; 
	    height:40px; 
	    width: 150px;
	    font-size: 16px;
	    padding-top: 10px; 
	    padding-bottom: 10px;
	    padding-right: 10px;
	    padding-left: 10px;
	    box-sizing: border-box;
    	box-shadow: 0 0 5px #333;
	}
	.color {
		color: #565a5c;
	}
	.ui-text {
		margin-bottom: 20px;
	}
	.ui-bottom {
		float: left;

		padding: 0px 25px 20px 25px;
		text-align: center;
		font-size: 17px;
		line-height: 20px;
		margin-bottom:15px;
	}
	.ui-post-signup {
		margin-top: 50px;
		height: 400px;
	}
	.ui-post-signup-more {
		color: blue;
		margin-top: 20px;
	}
	.ui-post-signup-details {
		margin-top: 20px;
	}
	.ui-copy-link-button {
		width: 100px;
		text-align: center;
		margin-right: auto;
		margin-left: auto;
		margin-top: 20px;
	}
	/*
	.background {
	}
	.ui-phone-num::after {
	  content: "";
	  background: url(/resources/4a_noiPhone.jpg);
	  opacity: 0.5;
	  top: 0;
	  left: 0;
	  bottom: 0;
	  right: 0;
	  position: absolute;
	  z-index: -1;  
	}
	*/
	</style>
</head>
<body>

<div class='ui-content'>

	<div class='ui-header'>
		<img class='ui-icon' src='/resources/images/swap_icon.png'> 
		<div class='ui-header-lhs'>
			<div class='ui-header-top-text'> Swap Beta </div>
			<div class='ui-header-bottom-text'> Duffy, Inc. </div>
		</div>
		<div class='ui-header-rhs'>
			<div class='ui-clickable-button ui-install-button' id='install-text'> Signup </div>
		</div>
	</div>

	<div class='ui-body'>

		<div class='ui-pages'>
			<div class='ui-screenshots'>
				<img class='ui-image' id='main-image' src='/resources/images/1a.jpg'>
			</div>

			<div class="ui-bottom"> 
				Get notified when you take a picture with your friends!
			</div>
		</div>
		<div class='ui-pages'>
			<div class='ui-screenshots'>
				<img class='ui-image' src='/resources/images/4a.jpg'>
			</div>

			<div class="ui-bottom"> 
				Build a shared gallery with friends!
			</div>
		</div>		
		<div class='ui-pages'>
			<div class='ui-screenshots'>
				<img class='ui-image' src='/resources/images/2a.jpg'>
			</div>

			<div class="ui-bottom"> 
				Share photos with a single tap - friends who were there are preselected!
			</div>
		</div>
		<div class='ui-pages'>
			<div class='ui-screenshots'>
				<img class='ui-image' src='/resources/images/3a.jpg'>
			</div>

			<div class="ui-bottom"> 
				Like and comment privately with friends on a photo!
			</div>
		</div>
		<div class="ui-phone-num post-install hidden"> 
			<div class="ui-text"> 
				Enter your phone number to get an invite:
			</div>
			<form id='phoneform' action='http://dev.duffyapp.com:8000/strand/api/website_registration'>
				<input name='phone_number' class="textbox" type="text" id="phone" placeholder="(843) 555-5555">
				<input type="hidden" name='source' value='main'>
			</form>
			<div class='ui-clickable-button ui-submit-button'> Submit </div>

		</div>
		<div class='ui-bottom ui-post-signup hidden' id='post-signup'>
			Thanks. You should get a confirmation SMS shortly.
			<div class="ui-post-signup-more"> How do I get access sooner?</div>
			<div class="ui-post-signup-details hidden"> More friends on Swap means better photo suggestions for you.
				Invite your friends and we'll bump you up on the waitlist. 
				<br>
				<br>
				Use your personalized url:
				<textarea id='link'></textarea>
			</div>
		</div>
	</div>

</div>

</body>
<script>
	function signupClicked(){
		$('#install-text').empty();
		$('#install-text').append("See below");
		$('#install-text').addClass('ui-button-clicked');
		$('div.ui-pages').fadeOut(200);
		$('div.post-install').fadeIn(200);
		localytics.tagEvent("DL_Swap_2");
	}

	function getCode(){
		pathname = window.location.pathname;
		lastToken = pathname.substr(pathname.lastIndexOf('/'));
		if (lastToken.indexOf('html') == -1 && lastToken.length > 5) {
			return lastToken.substr(1);
		}
		// Otherwise, return a new code
		return genCode()
	}

	/* 
	Generates a 6 character code
	*/
	function genCode()
	{
	    var text = "";
	    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

	    for( var i=0; i < 6; i++ )
	        text += possible.charAt(Math.floor(Math.random() * possible.length));

	    return text;
	}	

	function detectiPhone(){
		var ua = navigator.userAgent;
		if(ua.match(/iPhone/i)){
			return true;
		}
		return false;
	}

	$(document).ready(function(){
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  	ga('create', 'UA-53853203-1', 'auto');
	  	ga('send', 'pageview');

	  	// Install button clicked
		$('div.ui-install-button').click(function() {
			signupClicked();
		});

		// submit button clicked
		$('div.ui-submit-button').click(function(){
			if ($('#phone').val().indexOf("5555") == -1){
				url = 'http://prod.strand.duffyapp.com/strand/api/website_registration';
				code = getCode();
				console.log(code);
				$.ajax({
	     			url: url,
	     			type: 'get',
	     			dataType: 'jsonp',
	     			data: { phone_number: $('#phone').val(), source: 'index.html', invite_code: code },
	     			success: function(data) {
						$('div.post-install').fadeOut(200, function(){
							$('#post-signup').fadeIn(200);
						});
						$('#link').append('swapapp.co/'+code);
	     			}
	 			});		
			}
		});

		// More info on signup button clicked
		$('div.ui-post-signup-more').click(function(){
			$('div.ui-post-signup-details').fadeIn(200);
		});

		// Textarea selected to copy link
		$("#link").focus(function(){
			this.setSelectionRange(0, 9999); 
			return false; 
		}).mouseup(function(){ 
			return false; });

		// phonenum field in focus
		$('#phone').focus(function() {
			$(this).addClass('color');
		});

		// Enable mask on phonenum
		$('#phone').mask("(999) 999-9999");
	});
	
</script>
</html>
